$(window).on("load",function(){var t=d3.select("#vertical-sankey"),n={top:20,right:20,bottom:30,left:50},e=t.node().getBoundingClientRect().width-n.left-n.right,r=650-n.top-n.bottom,a=d3.format(",.0f"),o=function(t){return a(t)+"m CHF"},d=d3.scale.ordinal().range(["#99B898","#FECEA8","#FF847C","#E84A5F","#F8B195","#F67280","#C06C84"]),i=t.append("svg"),l=i.attr("width",e+n.left+n.right).attr("height",r+n.top+n.bottom).append("g").attr("transform","translate("+n.left+","+n.top+")"),s=d3.sankey().nodeWidth(25).nodePadding(20).size([e,r]),c=s.link();d3.json("../../../app-assets/data/d3/other/sankey.json",function(t,n){function r(t){d3.select(this).attr("transform","translate("+(t.x=Math.max(0,Math.min(e-t.dy,d3.event.x)))+","+t.y+")"),s.relayout(),a.attr("d",c)}if(t)throw t;s.nodes(n.nodes).links(n.links).layout(32);var a=l.append("g").selectAll(".link").data(n.links).enter().append("path").attr("class","link").attr("d",c).style("stroke-width",function(t){return Math.max(1,t.dy)}).style("stroke",function(t){return t.source.color=d(t.source.name.replace(/ .*/,""))}).style("fill","none").style("stroke-opacity","0.5").sort(function(t,n){return n.dy-t.dy});a.append("title").text(function(t){return t.source.name+" â†’ "+t.target.name+"\n"+o(t.value)});var i=l.append("g").selectAll(".node").data(n.nodes).enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).call(d3.behavior.drag().origin(function(t){return t}).on("dragstart",function(){this.parentNode.appendChild(this)}).on("drag",r));i.append("rect").attr("height",s.nodeWidth()).attr("width",function(t){return t.dy}).style("fill",function(t){return t.color=d(t.name.replace(/ .*/,""))}).style("stroke",function(t){return d3.rgb(t.color).darker(2)}).style("fill-opacity","0.9").append("title").text(function(t){return t.name+"\n"+o(t.value)}),i.append("text").attr("text-anchor","middle").attr("x",function(t){return t.dy/2}).attr("y",s.nodeWidth()/2).attr("dy",".35em").text(function(t){return t.name}).filter(function(t){return t.x<e/2})})});
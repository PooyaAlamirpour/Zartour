$(window).on("load",function(){function t(){clearTimeout(A),"grouped"===this.value?n():r()}function n(){m.domain([0,g]),b.transition().duration(500).delay(function(t,n){return 10*n}).attr("x",function(t,n,r){return y(t.x)+y.rangeBand()/c*r}).attr("width",y.rangeBand()/c).transition().attr("y",function(t){return m(t.y)}).attr("height",function(t){return u-m(t.y)})}function r(){m.domain([0,h]),b.transition().duration(500).delay(function(t,n){return 10*n}).attr("y",function(t){return m(t.y0+t.y)}).attr("height",function(t){return m(t.y0)-m(t.y0+t.y)}).transition().attr("x",function(t){return y(t.x)}).attr("width",y.rangeBand())}function a(t,n){function r(n){for(var r=1/(.1+Math.random()),a=2*Math.random()-.5,e=10/(.1+Math.random()),i=0;i<t;i++){var o=(i/t-a)*e;n[i]+=r*Math.exp(-o*o)}}var a,e=[];for(a=0;a<t;++a)e[a]=n+n*Math.random();for(a=0;a<5;++a)r(e);return e.map(function(t,n){return{x:n,y:Math.max(0,t)}})}function e(){d=i.node().getBoundingClientRect().width-o.left-o.right,w.attr("width",d+o.left+o.right),v.attr("width",d+o.left+o.right),y.rangeRoundBands([0,d],.08),v.selectAll(".d3-xaxis").call(x),v.selectAll(".d3-bar").attr("x",function(t){return y(t.x)})}var i=d3.select("#stacked-to-grouped"),o={top:20,right:20,bottom:30,left:50},d=i.node().getBoundingClientRect().width-o.left-o.right,u=500-o.top-o.bottom,c=4,l=58,f=d3.layout.stack(),s=f(d3.range(c).map(function(){return a(l,.1)})),g=d3.max(s,function(t){return d3.max(t,function(t){return t.y})}),h=d3.max(s,function(t){return d3.max(t,function(t){return t.y0+t.y})}),y=d3.scale.ordinal().domain(d3.range(l)).rangeRoundBands([0,d],.08),m=d3.scale.linear().domain([0,h]).range([u,0]),p=d3.scale.linear().domain([0,c-1]).range(["#FECEA8","#E84A5F"]),x=d3.svg.axis().scale(y).tickSize(0).tickPadding(6).orient("bottom"),w=i.append("svg"),v=w.attr("width",d+o.left+o.right).attr("height",u+o.top+o.bottom).append("g").attr("transform","translate("+o.left+","+o.top+")"),B=v.selectAll(".layer").data(s).enter().append("g").attr("class","layer").style("fill",function(t,n){return p(n)}),b=B.selectAll(".d3-bar").data(function(t){return t}).enter().append("rect").attr("class","d3-bar").attr("x",function(t){return y(t.x)}).attr("y",u).attr("width",y.rangeBand()).attr("height",0);b.transition().delay(function(t,n){return 10*n}).attr("y",function(t){return m(t.y0+t.y)}).attr("height",function(t){return m(t.y0)-m(t.y0+t.y)}),v.append("g").attr("class","d3-axis d3-xaxis").attr("transform","translate(0,"+u+")").call(x),d3.selectAll("input").on("change",t);var A=setTimeout(function(){d3.select('input[value="grouped"]').property("checked",!0).each(t)},2e3);$(window).on("resize",e),$(".menu-toggle").on("click",e)});
$(window).on("load",function(){function t(t,n){var e=(t.endAngle-t.startAngle)/t.value;return d3.range(0,t.value,n).map(function(n){return{value:n,angle:n*e+t.startAngle}})}var n=d3.select("#chord-diagram"),e=600,r=600,a=d3.formatPrefix(",.0",1e3),d=[[11975,5871,8916,2868],[1951,10048,2060,6171],[8010,16145,8090,8045],[1013,990,940,6907]],l=d3.scale.ordinal().domain(d3.range(4)).range(["#99B898","#FECEA8","#FF847C","#E84A5F"]),u=n.append("svg"),o=u,i=.5*Math.min(e,r)-40,s=i-30,c=d3.chord().padAngle(.05).sortSubgroups(d3.descending),g=d3.svg.arc().innerRadius(s).outerRadius(i),p=d3.ribbon().radius(s),f=o.append("g").attr("transform","translate("+e/2+","+r/2+")").datum(c(d)),h=f.append("g").attr("class","groups").selectAll("g").data(function(t){return t.groups}).enter().append("g");h.append("path").style("fill",function(t){return l(t.index)}).style("stroke",function(t){return d3.rgb(l(t.index)).darker()}).attr("d",g);var m=h.selectAll(".group-tick").data(function(n){return t(n,1e3)}).enter().append("g").attr("class","group-tick").attr("transform",function(t){return"rotate("+(180*t.angle/Math.PI-90)+") translate("+i+",0)"});m.append("line").attr("x2",6),m.filter(function(t){return t.value%5e3===0}).append("text").attr("x",8).attr("dy",".35em").attr("transform",function(t){return t.angle>Math.PI?"rotate(180) translate(-16)":null}).style("text-anchor",function(t){return t.angle>Math.PI?"end":null}).text(function(t){return a(t.value)}),f.append("g").attr("class","ribbons").selectAll("path").data(function(t){return t}).enter().append("path").attr("d",p).style("fill",function(t){return l(t.target.index)}).style("stroke",function(t){return d3.rgb(l(t.target.index)).darker()})});